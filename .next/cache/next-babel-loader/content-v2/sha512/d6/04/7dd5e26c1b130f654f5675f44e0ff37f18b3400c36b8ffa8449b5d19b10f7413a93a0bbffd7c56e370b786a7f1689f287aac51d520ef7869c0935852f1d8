{"ast":null,"code":"/**\r\n* PHP Email Form Validation - v3.6\r\n* URL: https://bootstrapmade.com/php-email-form/\r\n* Author: BootstrapMade.com\r\n*/\n(function () {\n  \"use strict\";\n\n  let forms = document.querySelectorAll('.php-email-form');\n  forms.forEach(function (e) {\n    e.addEventListener('submit', function (event) {\n      event.preventDefault();\n      let thisForm = this;\n      let action = thisForm.getAttribute('action');\n      let recaptcha = thisForm.getAttribute('data-recaptcha-site-key');\n\n      if (!action) {\n        displayError(thisForm, 'The form action property is not set!');\n        return;\n      }\n\n      thisForm.querySelector('.loading').classList.add('d-block');\n      thisForm.querySelector('.error-message').classList.remove('d-block');\n      thisForm.querySelector('.sent-message').classList.remove('d-block');\n      let formData = new FormData(thisForm);\n\n      if (recaptcha) {\n        if (typeof grecaptcha !== \"undefined\") {\n          grecaptcha.ready(function () {\n            try {\n              grecaptcha.execute(recaptcha, {\n                action: 'php_email_form_submit'\n              }).then(token => {\n                formData.set('recaptcha-response', token);\n                php_email_form_submit(thisForm, action, formData);\n              });\n            } catch (error) {\n              displayError(thisForm, error);\n            }\n          });\n        } else {\n          displayError(thisForm, 'The reCaptcha javascript API url is not loaded!');\n        }\n      } else {\n        php_email_form_submit(thisForm, action, formData);\n      }\n    });\n  });\n\n  function php_email_form_submit(thisForm, action, formData) {\n    fetch(action, {\n      method: 'POST',\n      body: formData,\n      headers: {\n        'X-Requested-With': 'XMLHttpRequest'\n      }\n    }).then(response => {\n      if (response.ok) {\n        return response.text();\n      } else {\n        throw new Error(`${response.status} ${response.statusText} ${response.url}`);\n      }\n    }).then(data => {\n      thisForm.querySelector('.loading').classList.remove('d-block');\n\n      if (data.trim() == 'OK') {\n        thisForm.querySelector('.sent-message').classList.add('d-block');\n        thisForm.reset();\n      } else {\n        throw new Error(data ? data : 'Form submission failed and no error message returned from: ' + action);\n      }\n    }).catch(error => {\n      displayError(thisForm, error);\n    });\n  }\n\n  function displayError(thisForm, error) {\n    thisForm.querySelector('.loading').classList.remove('d-block');\n    thisForm.querySelector('.error-message').innerHTML = error;\n    thisForm.querySelector('.error-message').classList.add('d-block');\n  }\n})();","map":null,"metadata":{},"sourceType":"script"}